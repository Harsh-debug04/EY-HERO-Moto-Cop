<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vidyutt Dashboard</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Dashboard = () => {
            const [stats, setStats] = useState({
                uptime: "Loading...",
                critical_alerts: 0,
                active_calls: 0,
                service_bay_utilization: "0%"
            });
            const [logs, setLogs] = useState([]);

            // Simulate fetching data from backend
            useEffect(() => {
                const fetchStats = async () => {
                    try {
                        const response = await fetch('http://localhost:8000/dashboard/stats');
                        if (response.ok) {
                            const data = await response.json();
                            setStats(data);
                        }
                    } catch (error) {
                        console.error("Failed to fetch stats", error);
                    }
                };

                // Polling simulation
                const interval = setInterval(fetchStats, 5000);
                fetchStats(); // Initial call
                return () => clearInterval(interval);
            }, []);

            return (
                <div className="flex flex-col h-screen">
                    {/* Header */}
                    <header className="bg-gray-800 border-b border-gray-700 p-4 flex justify-between items-center">
                        <div className="flex items-center space-x-3">
                            <i className="fas fa-bolt text-yellow-400 text-2xl"></i>
                            <h1 className="text-xl font-bold tracking-wide">VIDYUTT <span className="text-gray-400 text-sm font-normal">| Faceless Agentic Orchestrator</span></h1>
                        </div>
                        <div className="flex items-center space-x-6">
                            <div className="text-center">
                                <span className="block text-2xl font-bold text-green-400">{stats.uptime}</span>
                                <span className="text-xs text-gray-400">Fleet Uptime</span>
                            </div>
                            <div className="text-center">
                                <span className="block text-2xl font-bold text-yellow-400">{stats.critical_alerts}</span>
                                <span className="text-xs text-gray-400">Critical Alerts</span>
                            </div>
                            <div className="text-center">
                                <span className="block text-2xl font-bold text-blue-400">{stats.active_calls}</span>
                                <span className="text-xs text-gray-400">Active Calls</span>
                            </div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="flex-1 flex overflow-hidden">
                        {/* Sidebar */}
                        <aside className="w-64 bg-gray-800 border-r border-gray-700 p-4 space-y-4 hidden md:block">
                            <nav className="space-y-2">
                                <a href="#" className="block p-3 bg-gray-700 rounded text-white font-medium border-l-4 border-blue-500"><i className="fas fa-map-marked-alt mr-2"></i> Fleet Overview</a>
                                <a href="#" className="block p-3 text-gray-400 hover:bg-gray-700 hover:text-white rounded"><i className="fas fa-headset mr-2"></i> Live Conversations</a>
                                <a href="#" className="block p-3 text-gray-400 hover:bg-gray-700 hover:text-white rounded"><i className="fas fa-shield-alt mr-2"></i> UEBA Security</a>
                            </nav>
                        </aside>

                        {/* Dashboard Area */}
                        <div className="flex-1 p-6 overflow-y-auto bg-gray-900">
                             <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                {/* Simulated Live Anomaly Card */}
                                <div className="bg-gray-800 rounded-lg p-5 border border-red-500 shadow-[0_0_15px_rgba(239,68,68,0.3)]">
                                    <div className="flex justify-between items-start mb-4">
                                        <div>
                                            <h3 className="font-bold text-lg text-white">KA-05-MJ-2023</h3>
                                            <p className="text-xs text-gray-400">Model: XUV700</p>
                                        </div>
                                        <span className="px-2 py-1 bg-red-900 text-red-300 text-xs rounded font-bold animate-pulse">CRITICAL</span>
                                    </div>
                                    <div className="space-y-3">
                                        <div className="flex justify-between text-sm">
                                            <span className="text-gray-400">Engine Temp</span>
                                            <span className="text-red-400 font-bold">118Â°C <i className="fas fa-arrow-up"></i></span>
                                        </div>
                                        <div className="w-full bg-gray-700 h-2 rounded-full overflow-hidden">
                                            <div className="bg-red-500 h-full" style={{width: '88%'}}></div>
                                        </div>
                                        <p className="text-xs text-red-300 mt-2"><i className="fas fa-exclamation-triangle"></i> Water Pump Failure Probability 88%</p>
                                    </div>
                                    <div className="mt-4 pt-4 border-t border-gray-700">
                                        <div className="flex items-center text-sm text-blue-400">
                                            <i className="fas fa-phone-volume mr-2 animate-bounce"></i> Agent Calling Customer...
                                        </div>
                                    </div>
                                </div>

                                {/* Vehicle Card - Warning */}
                                <div className="bg-gray-800 rounded-lg p-5 border-l-4 border-yellow-500">
                                    <div className="flex justify-between items-start mb-4">
                                        <div>
                                            <h3 className="font-bold text-lg text-white">MH-02-DN-4412</h3>
                                            <p className="text-xs text-gray-400">Model: Scorpio N</p>
                                        </div>
                                        <span className="px-2 py-1 bg-yellow-900 text-yellow-300 text-xs rounded font-bold">WARNING</span>
                                    </div>
                                    <div className="space-y-3">
                                        <div className="flex justify-between text-sm">
                                            <span className="text-gray-400">Battery Voltage</span>
                                            <span className="text-yellow-400 font-bold">11.2V <i className="fas fa-arrow-down"></i></span>
                                        </div>
                                        <div className="flex justify-between text-sm">
                                            <span className="text-gray-400">Last Service</span>
                                            <span className="text-gray-300">180 days ago</span>
                                        </div>
                                    </div>
                                    <div className="mt-4 pt-4 border-t border-gray-700">
                                        <button className="w-full py-2 bg-gray-700 hover:bg-gray-600 text-sm rounded text-gray-300">View Telematics</button>
                                    </div>
                                </div>

                                {/* Vehicle Card - Normal */}
                                <div className="bg-gray-800 rounded-lg p-5 border-l-4 border-green-500 opacity-70">
                                    <div className="flex justify-between items-start mb-4">
                                        <div>
                                            <h3 className="font-bold text-lg text-white">DL-8C-NB-1092</h3>
                                            <p className="text-xs text-gray-400">Model: Thar</p>
                                        </div>
                                        <span className="px-2 py-1 bg-green-900 text-green-300 text-xs rounded font-bold">HEALTHY</span>
                                    </div>
                                    <div className="space-y-3">
                                        <div className="flex justify-between text-sm">
                                            <span className="text-gray-400">Status</span>
                                            <span className="text-green-400 font-bold">Optimal</span>
                                        </div>
                                        <div className="flex justify-between text-sm">
                                            <span className="text-gray-400">Speed</span>
                                            <span className="text-gray-300">65 km/h</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Dashboard />);
    </script>
</body>
</html>
